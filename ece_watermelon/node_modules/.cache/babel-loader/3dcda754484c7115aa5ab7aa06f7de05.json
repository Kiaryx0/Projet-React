{"ast":null,"code":"import { getSessionUser } from \"./DatabaseSession\"; /// This file contains all the functions related to the wallet data access\n\n/**\r\n * Returns the wallet of the current session user and return null if no one's logged in\r\n */\n\nexport default function getSessionWallet() {\n  let user = getSessionUser();\n  let wallets = JSON.parse(localStorage.getItem(\"wallets\"));\n  let array = wallets.filter(w => {\n    return w.user_id === user.id;\n  }); // If wallet found return it\n\n  if (array.length === 1) {\n    return array[0];\n  } // Else return null\n  else {\n      return null;\n    }\n}\n/**\r\n * Return the balance of the wallet as string\r\n */\n\nexport function getWalletAmount() {\n  let wallet = getSessionWallet(getSessionUser());\n\n  if (wallet != null) {\n    return (wallet.balance / 100.0).toFixed(2);\n  }\n}\n/**\r\n * Make a deposit on the count using the credit card\r\n * @param {Amount of money in cents '1700' = 17.00€} money \r\n * @param {Credit card} card \r\n */\n\nexport function makeDeposit(money, card) {\n  // Credit wallet\n  let wallets = JSON.parse(localStorage.getItem(\"wallets\"));\n  let current = null;\n\n  for (var i = 0; i < wallets.length; i++) {\n    if (wallets[i].user_id === card.user_id) {\n      wallets[i].balance -= money;\n      current = wallets[i];\n    }\n  }\n\n  localStorage.setItem(\"wallets\", JSON.stringify(wallets)); // Save Payout\n\n  let payouts = JSON.parse(localStorage.getItem(\"payouts\"));\n  payouts.push({\n    id: payouts.length + 1,\n    wallet_id: current.id,\n    amount: money\n  });\n  localStorage.setItem(\"payouts\", JSON.stringify(payouts));\n}\n/**\r\n * Make a deposit on the count using the credit card\r\n * @param {Amount of money in cents '1700' = 17.00€} money \r\n * @param {Credit card} card \r\n */\n\nexport function makeWithdrawal(money, card) {\n  // Credit wallet\n  let wallets = JSON.parse(localStorage.getItem(\"wallets\"));\n  let current = null;\n\n  for (var i = 0; i < wallets.length; i++) {\n    if (wallets[i].user_id === card.user_id) {\n      wallets[i].balance += money;\n      current = wallets[i];\n    }\n  }\n\n  localStorage.setItem(\"wallets\", JSON.stringify(wallets)); // Save Payout\n\n  let payins = JSON.parse(localStorage.getItem(\"payins\"));\n  payins.push({\n    id: payins.length + 1,\n    wallet_id: current.id,\n    amount: money\n  });\n  localStorage.setItem(\"payins\", JSON.stringify(payins));\n}\nexport function getSessionDeposits() {\n  let walletID = getSessionWallet().id;\n  let deposit = JSON.parse(localStorage.getItem(\"payouts\"));\n\n  if (deposit !== null) {\n    deposit.reverse();\n  }\n\n  return deposit.filter(d => {\n    return d.id === walletID;\n  });\n}\nexport function getSessionWithdrawals() {\n  let walletID = getSessionWallet().id;\n  let withdrawal = JSON.parse(localStorage.getItem(\"payins\"));\n\n  if (withdrawal !== null) {\n    withdrawal.reverse();\n  }\n\n  return withdrawal.filter(w => {\n    return w.id === walletID;\n  });\n}\nexport function getSessionTransfers() {\n  let walletID = getSessionWallet().id;\n  let transfer = JSON.parse(localStorage.getItem(\"transfers\"));\n\n  if (transfer !== null) {\n    transfer.reverse();\n  }\n\n  return transfer.filter(t => {\n    return t.id === walletID;\n  });\n}","map":{"version":3,"sources":["D:\\Documents\\GitHub\\Projet-React\\ece_watermelon\\src\\Database\\DatabaseWallet.js"],"names":["getSessionUser","getSessionWallet","user","wallets","JSON","parse","localStorage","getItem","array","filter","w","user_id","id","length","getWalletAmount","wallet","balance","toFixed","makeDeposit","money","card","current","i","setItem","stringify","payouts","push","wallet_id","amount","makeWithdrawal","payins","getSessionDeposits","walletID","deposit","reverse","d","getSessionWithdrawals","withdrawal","getSessionTransfers","transfer","t"],"mappings":"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","sourcesContent":["import { getSessionUser } from \"./DatabaseSession\";\r\n\r\n/// This file contains all the functions related to the wallet data access\r\n\r\n/**\r\n * Returns the wallet of the current session user and return null if no one's logged in\r\n */\r\nexport default function getSessionWallet(){\r\n\r\n    let user = getSessionUser();\r\n    let wallets = JSON.parse(localStorage.getItem(\"wallets\"))\r\n\r\n    let array = wallets.filter(w=>{\r\n        return w.user_id === user.id;\r\n    });\r\n\r\n    // If wallet found return it\r\n    if(array.length === 1){\r\n        return array[0];\r\n    }\r\n    // Else return null\r\n    else{\r\n        return null;\r\n    }\r\n}\r\n\r\n/**\r\n * Return the balance of the wallet as string\r\n */\r\nexport function getWalletAmount(){\r\n    let wallet = getSessionWallet(getSessionUser());\r\n    if(wallet != null){\r\n        return (wallet.balance / 100.0).toFixed(2);\r\n    }\r\n}\r\n\r\n/**\r\n * Make a deposit on the count using the credit card\r\n * @param {Amount of money in cents '1700' = 17.00€} money \r\n * @param {Credit card} card \r\n */\r\nexport function makeDeposit(money, card){\r\n    \r\n    // Credit wallet\r\n    let wallets = JSON.parse(localStorage.getItem(\"wallets\"));\r\n    let current = null;\r\n    for(var i= 0; i<wallets.length; i++){\r\n        if(wallets[i].user_id === card.user_id){\r\n            wallets[i].balance -= money;\r\n            current = wallets[i];\r\n        }\r\n    }\r\n    localStorage.setItem(\"wallets\", JSON.stringify(wallets));\r\n\r\n    // Save Payout\r\n    let payouts = JSON.parse(localStorage.getItem(\"payouts\"));\r\n    payouts.push({   id: payouts.length+1, wallet_id: current.id, amount: money })\r\n    localStorage.setItem(\"payouts\", JSON.stringify(payouts));\r\n}\r\n\r\n/**\r\n * Make a deposit on the count using the credit card\r\n * @param {Amount of money in cents '1700' = 17.00€} money \r\n * @param {Credit card} card \r\n */\r\nexport function makeWithdrawal(money, card){\r\n    \r\n    // Credit wallet\r\n    let wallets = JSON.parse(localStorage.getItem(\"wallets\"));\r\n    let current = null;\r\n    for(var i= 0; i<wallets.length; i++){\r\n        if(wallets[i].user_id === card.user_id){\r\n            wallets[i].balance += money;\r\n            current = wallets[i];\r\n        }\r\n    }\r\n    localStorage.setItem(\"wallets\", JSON.stringify(wallets));\r\n\r\n    // Save Payout\r\n    let payins = JSON.parse(localStorage.getItem(\"payins\"));\r\n    payins.push({   id: payins.length+1, wallet_id: current.id, amount: money })\r\n    localStorage.setItem(\"payins\", JSON.stringify(payins));\r\n}\r\n\r\nexport function getSessionDeposits(){\r\n    let walletID = getSessionWallet().id;\r\n    let deposit = JSON.parse(localStorage.getItem(\"payouts\"))\r\n    if(deposit !== null){\r\n        deposit.reverse()\r\n    }\r\n    return deposit.filter(d=>{\r\n        return d.id === walletID;\r\n    })\r\n}\r\n\r\nexport function getSessionWithdrawals(){\r\n    let walletID = getSessionWallet().id;\r\n    let withdrawal = JSON.parse(localStorage.getItem(\"payins\"))\r\n    if(withdrawal !== null){\r\n        withdrawal.reverse()\r\n    }\r\n    return withdrawal.filter(w=>{\r\n        return w.id === walletID;\r\n    })\r\n}\r\n\r\nexport function getSessionTransfers(){\r\n    let walletID = getSessionWallet().id;\r\n    let transfer = JSON.parse(localStorage.getItem(\"transfers\"))\r\n    if(transfer !== null){\r\n        transfer.reverse()\r\n    }\r\n    return transfer.filter(t=>{\r\n        return t.id === walletID;\r\n    })\r\n}"]},"metadata":{},"sourceType":"module"}